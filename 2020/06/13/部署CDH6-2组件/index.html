<!DOCTYPE html><html lang="zh-CN"><head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="xinshiyou">
  <meta name="keywords" content="">
  <title>部署CDH6.2组件 - 星空捞月：找寻心中的安宁</title>

  


  
  

  
    
  

  


<!-- 主题依赖的图标库，不要自行修改 -->










<!-- 自定义样式保持在最底部 -->


  
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="星空捞月：找寻心中的安宁" type="application/atom+xml">
<script>function loadCss(l){var d=document,h=d.head,s=d.createElement('link');s.rel='stylesheet';s.href=l;!function e(f){if (d.body)return f();setTimeout(function(){e(f)})}(function(){h.appendChild(s);});}loadCss('/style.css');loadCss('https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css');loadCss('https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css');loadCss('https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css');loadCss('//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css');loadCss('//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css');loadCss('https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css');</script><noscript><link rel="stylesheet" href="/style.css"><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css"><link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"></noscript></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">&nbsp;<strong>星空捞月：找寻心中的安宁</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax="true" style="background: url('/img/top.jpeg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2020-06-13 18:22">
      2020年6月13日 晚上
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3.9k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      77
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <!-- TOC -->

<ul>
<li><a href="#1-下载组件">.1. 下载组件</a></li>
<li><a href="#2-部署安装">.2. 部署安装</a><ul>
<li><a href="#21-配置文件----configini--cloudera-scm-agent需要">.2.1. 配置文件 – config.ini : cloudera-scm-agent需要</a></li>
<li><a href="#22-dbproperties--cloudera-scm-server-需要">.2.2. db.properties : cloudera-scm-server 需要</a></li>
</ul>
</li>
<li><a href="#3-部署编排">.3. 部署编排</a></li>
<li><a href="#4-其他补充">.4. 其他补充</a><ul>
<li><a href="#41-创建mysql数据库">.4.1. 创建MySQL数据库</a></li>
<li><a href="#42-初始化scm数据库">.4.2. 初始化SCM数据库</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->

<h2 id="1-下载组件"><a href="#1-下载组件" class="headerlink" title=".1. 下载组件"></a>.1. 下载组件</h2><figure class="highlight"><table><tbody><tr><td class="gutter"><div class="hljs"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs"><pre class=" language-hljs json"><code class="language-hljs json">## 必须下载<br>### Cloudera Manager<br>cloudera-manager-agent-6.2.0-968826.el7.x86_64.rpm<br>cloudera-manager-daemons-6.2.0-968826.el7.x86_64.rpm<br>cloudera-manager-server-6.2.0-968826.el7.x86_64.rpm<br>cloudera-manager-server-db-2-6.2.0-968826.el7.x86_64.rpm<br><br>### CDH<br>manifest.json<br>CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel<br>CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel.sha<br>CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel.sha256<br><br>## 按需下载<br>oracle-j2sdk1.8-1.8.0+update181-1.x86_64.rpm<br><br>## 部署MySQL需要<br>mysql57-community-release-el7-7.noarch.rpm<br>mysql-connector-java.jar<br></code></pre></div></td></tr></tbody></table></figure>

<h2 id="2-部署安装"><a href="#2-部署安装" class="headerlink" title=".2. 部署安装"></a>.2. 部署安装</h2><h3 id="2-1-配置文件-–-config-ini-cloudera-scm-agent需要"><a href="#2-1-配置文件-–-config-ini-cloudera-scm-agent需要" class="headerlink" title=".2.1. 配置文件 – config.ini : cloudera-scm-agent需要"></a>.2.1. 配置文件 – config.ini : cloudera-scm-agent需要</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><div class="hljs"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br></pre></div></td><td class="code"><div class="hljs"><pre class=" language-hljs bash"><span class="hljs-comment"># Configuration file for cloudera-scm-agent.</span><br><span class="hljs-comment"># Please note that this file supports multi-line values.  Multi-line</span><br><span class="hljs-comment"># values are indicated by indenting following lines with a space.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># If you have whitespace in front of a parameter name, it will be</span><br><span class="hljs-comment"># read as a continuation of the previous parameter value.  Please</span><br><span class="hljs-comment"># be careful not to leave spaces in front of parameter names.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># To check if this file has spaces in front of parameters names</span><br><span class="hljs-comment"># you can do a grep like this:</span><br><span class="hljs-comment">#  grep '^[[:blank:]]' /etc/cloudera-scm-agent/config.ini</span><br><br>[General]<br><span class="hljs-comment"># Hostname of the CM server.</span><br>server_host={{ groups[<span class="hljs-string">'CDM'</span>][0] }}<br><br><span class="hljs-comment"># Port that the CM server is listening on.</span><br>server_port=7182<br><br><span class="hljs-comment">## It should not normally be necessary to modify these.</span><br><span class="hljs-comment"># Port that the CM agent should listen on.</span><br><span class="hljs-comment"># listening_port=9000</span><br><br><span class="hljs-comment"># IP Address that the CM agent should listen on.</span><br><span class="hljs-comment"># listening_ip=</span><br><br><span class="hljs-comment"># Hostname that the CM agent reports as its hostname. If unset, will be</span><br><span class="hljs-comment"># obtained in code through something like this:</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#   python -c 'import socket; \</span><br><span class="hljs-comment">#              print socket.getfqdn(), \</span><br><span class="hljs-comment">#                    socket.gethostbyname(socket.getfqdn())'</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># listening_hostname=</span><br><br><span class="hljs-comment"># An alternate hostname to report as the hostname for this host in CM.</span><br><span class="hljs-comment"># Useful when this agent is behind a load balancer or proxy and all</span><br><span class="hljs-comment"># inbound communication must connect through that proxy.</span><br><span class="hljs-comment"># reported_hostname=</span><br><br><span class="hljs-comment"># Port that supervisord should listen on.</span><br><span class="hljs-comment"># NB: This only takes effect if supervisord is restarted.</span><br><span class="hljs-comment"># supervisord_port=19001</span><br><br><span class="hljs-comment"># Log file.  The supervisord log file will be placed into</span><br><span class="hljs-comment"># the same directory.  Note that if the agent is being started via the</span><br><span class="hljs-comment"># init.d script, /var/log/cloudera-scm-agent/cloudera-scm-agent.out will</span><br><span class="hljs-comment"># also have a small amount of output (from before logging is initialized).</span><br><span class="hljs-comment"># log_file=/var/log/cloudera-scm-agent/cloudera-scm-agent.log</span><br><br><span class="hljs-comment"># Persistent state directory.  Directory to store CM agent state that</span><br><span class="hljs-comment"># persists across instances of the agent process and system reboots.</span><br><span class="hljs-comment"># Particularly, the agent's UUID is stored here.</span><br><span class="hljs-comment"># lib_dir=/var/lib/cloudera-scm-agent</span><br><br><span class="hljs-comment"># Parcel directory.  Unpacked parcels will be stored in this directory.</span><br><span class="hljs-comment"># Downloaded parcels will be stored in &lt;parcel_dir&gt;/../parcel-cache</span><br><span class="hljs-comment"># parcel_dir=/opt/cloudera/parcels</span><br><br><span class="hljs-comment"># Enable supervisord event monitoring.  Used in eager heartbeating, amongst</span><br><span class="hljs-comment"># other things.</span><br><span class="hljs-comment"># enable_supervisord_events=true</span><br><br><span class="hljs-comment"># Maximum time to wait (in seconds) for all metric collectors to finish</span><br><span class="hljs-comment"># collecting data.</span><br>max_collection_wait_seconds=10.0<br><br><span class="hljs-comment"># Maximum time to wait (in seconds) when connecting to a local role's</span><br><span class="hljs-comment"># webserver to fetch metrics.</span><br>metrics_url_timeout_seconds=30.0<br><br><span class="hljs-comment"># Maximum time to wait (in seconds) when connecting to a local TaskTracker</span><br><span class="hljs-comment"># to fetch task attempt data.</span><br>task_metrics_timeout_seconds=5.0<br><br><span class="hljs-comment"># The list of non-device (nodev) filesystem types which will be monitored.</span><br>monitored_nodev_filesystem_types=nfs,nfs4,tmpfs<br><br><span class="hljs-comment"># The list of filesystem types which are considered local for monitoring purposes.</span><br><span class="hljs-comment"># These filesystems are combined with the other local filesystem types found in</span><br><span class="hljs-comment"># /proc/filesystems</span><br>local_filesystem_whitelist=ext2,ext3,ext4,xfs<br><br><span class="hljs-comment"># The largest size impala profile log bundle that this agent will serve to the</span><br><span class="hljs-comment"># CM server. If the CM server requests more than this amount, the bundle will</span><br><span class="hljs-comment"># be limited to this size. All instances of this limit being hit are logged to</span><br><span class="hljs-comment"># the agent log.</span><br>impala_profile_bundle_max_bytes=1073741824<br><br><span class="hljs-comment"># The largest size stacks log bundle that this agent will serve to the CM</span><br><span class="hljs-comment"># server. If the CM server requests more than this amount, the bundle will be</span><br><span class="hljs-comment"># limited to this size. All instances of this limit being hit are logged to the</span><br><span class="hljs-comment"># agent log.</span><br>stacks_log_bundle_max_bytes=1073741824<br><br><span class="hljs-comment"># The size to which the uncompressed portion of a stacks log can grow before it</span><br><span class="hljs-comment"># is rotated. The log will then be compressed during rotation.</span><br>stacks_log_max_uncompressed_file_size_bytes=5242880<br><br><span class="hljs-comment"># The orphan process directory staleness threshold. If a diretory is more stale</span><br><span class="hljs-comment"># than this amount of seconds, CM agent will remove it.</span><br>orphan_process_dir_staleness_threshold=5184000<br><br><span class="hljs-comment"># The orphan process directory refresh interval. The CM agent will check the</span><br><span class="hljs-comment"># staleness of the orphan processes config directory every this amount of</span><br><span class="hljs-comment"># seconds.</span><br>orphan_process_dir_refresh_interval=3600<br><br><span class="hljs-comment"># A knob to control the agent logging level. The options are listed as follows:</span><br><span class="hljs-comment"># 1) DEBUG (set the agent logging level to 'logging.DEBUG')</span><br><span class="hljs-comment"># 2) INFO (set the agent logging level to 'logging.INFO')</span><br>scm_debug=INFO<br><br><span class="hljs-comment"># The DNS resolution collecion interval in seconds. A java base test program</span><br><span class="hljs-comment"># will be executed with at most this frequency to collect java DNS resolution</span><br><span class="hljs-comment"># metrics. The test program is only executed if the associated health test,</span><br><span class="hljs-comment"># Host DNS Resolution, is enabled.</span><br>dns_resolution_collection_interval_seconds=60<br><br><span class="hljs-comment"># The maximum time to wait (in seconds) for the java test program to collect</span><br><span class="hljs-comment"># java DNS resolution metrics.</span><br>dns_resolution_collection_timeout_seconds=30<br><br><span class="hljs-comment"># The directory location in which the agent-wide kerberos credential cache</span><br><span class="hljs-comment"># will be created.</span><br><span class="hljs-comment"># agent_wide_credential_cache_location=/var/run/cloudera-scm-agent</span><br><br>[Security]<br><span class="hljs-comment"># Use TLS and certificate validation when connecting to the CM server.</span><br>use_tls=0<br><br><span class="hljs-comment"># The maximum allowed depth of the certificate chain returned by the peer.</span><br><span class="hljs-comment"># The default value of 9 matches the default specified in openssl's</span><br><span class="hljs-comment"># SSL_CTX_set_verify.</span><br>max_cert_depth=9<br><br><span class="hljs-comment"># A file of CA certificates in PEM format. The file can contain several CA</span><br><span class="hljs-comment"># certificates identified by</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># -----BEGIN CERTIFICATE-----</span><br><span class="hljs-comment"># ... (CA certificate in base64 encoding) ...</span><br><span class="hljs-comment"># -----END CERTIFICATE-----</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># sequences. Before, between, and after the certificates text is allowed which</span><br><span class="hljs-comment"># can be used e.g. for descriptions of the certificates.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># The file is loaded once, the first time an HTTPS connection is attempted. A</span><br><span class="hljs-comment"># restart of the agent is required to pick up changes to the file.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Note that if neither verify_cert_file or verify_cert_dir is set, certificate</span><br><span class="hljs-comment"># verification will not be performed.</span><br><span class="hljs-comment"># verify_cert_file=</span><br><br><span class="hljs-comment"># Directory containing CA certificates in PEM format. The files each contain one</span><br><span class="hljs-comment"># CA certificate. The files are looked up by the CA subject name hash value,</span><br><span class="hljs-comment"># which must hence be available. If more than one CA certificate with the same</span><br><span class="hljs-comment"># name hash value exist, the extension must be different (e.g. 9d66eef0.0,</span><br><span class="hljs-comment"># 9d66eef0.1 etc). The search is performed in the ordering of the extension</span><br><span class="hljs-comment"># number, regardless of other properties of the certificates. Use the c_rehash</span><br><span class="hljs-comment"># utility to create the necessary links.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># The certificates in the directory are only looked up when required, e.g. when</span><br><span class="hljs-comment"># building the certificate chain or when actually performing the verification</span><br><span class="hljs-comment"># of a peer certificate. The contents of the directory can thus be changed</span><br><span class="hljs-comment"># without an agent restart.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># When looking up CA certificates, the verify_cert_file is first searched, then</span><br><span class="hljs-comment"># those in the directory. Certificate matching is done based on the subject name,</span><br><span class="hljs-comment"># the key identifier (if present), and the serial number as taken from the</span><br><span class="hljs-comment"># certificate to be verified. If these data do not match, the next certificate</span><br><span class="hljs-comment"># will be tried. If a first certificate matching the parameters is found, the</span><br><span class="hljs-comment"># verification process will be performed; no other certificates for the same</span><br><span class="hljs-comment"># parameters will be searched in case of failure.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Note that if neither verify_cert_file or verify_cert_dir is set, certificate</span><br><span class="hljs-comment"># verification will not be performed.</span><br><span class="hljs-comment"># verify_cert_dir=</span><br><br><span class="hljs-comment"># PEM file containing client private key.</span><br><span class="hljs-comment"># client_key_file=</span><br><br><span class="hljs-comment"># A command to run which returns the client private key password on stdout</span><br><span class="hljs-comment"># client_keypw_cmd=</span><br><br><span class="hljs-comment"># If client_keypw_cmd isn't specified, instead a text file containing</span><br><span class="hljs-comment"># the client private key password can be used.</span><br><span class="hljs-comment"># client_keypw_file=</span><br><br><span class="hljs-comment"># PEM file containing client certificate.</span><br><span class="hljs-comment"># client_cert_file=</span><br><br><span class="hljs-comment">## Location of Hadoop files.  These are the CDH locations when installed by</span><br><span class="hljs-comment">## packages.  Unused when CDH is installed by parcels.</span><br>[Hadoop]<br><span class="hljs-comment">#cdh_crunch_home=/usr/lib/crunch</span><br><span class="hljs-comment">#cdh_flume_home=/usr/lib/flume-ng</span><br><span class="hljs-comment">#cdh_hadoop_bin=/usr/bin/hadoop</span><br><span class="hljs-comment">#cdh_hadoop_home=/usr/lib/hadoop</span><br><span class="hljs-comment">#cdh_hbase_home=/usr/lib/hbase</span><br><span class="hljs-comment">#cdh_hbase_indexer_home=/usr/lib/hbase-solr</span><br><span class="hljs-comment">#cdh_hcat_home=/usr/lib/hive-hcatalog</span><br><span class="hljs-comment">#cdh_hdfs_home=/usr/lib/hadoop-hdfs</span><br><span class="hljs-comment">#cdh_hive_home=/usr/lib/hive</span><br><span class="hljs-comment">#cdh_httpfs_home=/usr/lib/hadoop-httpfs</span><br><span class="hljs-comment">#cdh_hue_home=/usr/share/hue</span><br><span class="hljs-comment">#cdh_hue_plugins_home=/usr/lib/hadoop</span><br><span class="hljs-comment">#cdh_impala_home=/usr/lib/impala</span><br><span class="hljs-comment">#cdh_kudu_home=/usr/lib/kudu</span><br><span class="hljs-comment">#cdh_llama_home=/usr/lib/llama</span><br><span class="hljs-comment">#cdh_mr1_home=/usr/lib/hadoop-0.20-mapreduce</span><br><span class="hljs-comment">#cdh_mr2_home=/usr/lib/hadoop-mapreduce</span><br><span class="hljs-comment">#cdh_oozie_home=/usr/lib/oozie</span><br><span class="hljs-comment">#cdh_parquet_home=/usr/lib/parquet</span><br><span class="hljs-comment">#cdh_pig_home=/usr/lib/pig</span><br><span class="hljs-comment">#cdh_solr_home=/usr/lib/solr</span><br><span class="hljs-comment">#cdh_spark_home=/usr/lib/spark</span><br><span class="hljs-comment">#cdh_sqoop_home=/usr/lib/sqoop</span><br><span class="hljs-comment">#cdh_sqoop2_home=/usr/lib/sqoop2</span><br><span class="hljs-comment">#cdh_yarn_home=/usr/lib/hadoop-yarn</span><br><span class="hljs-comment">#cdh_zookeeper_home=/usr/lib/zookeeper</span><br><span class="hljs-comment">#hive_default_xml=/etc/hive/conf.dist/hive-default.xml</span><br><span class="hljs-comment">#webhcat_default_xml=/etc/hive-webhcat/conf.dist/webhcat-default.xml</span><br><span class="hljs-comment">#jsvc_home=/usr/libexec/bigtop-utils</span><br><span class="hljs-comment">#tomcat_home=/usr/lib/bigtop-tomcat</span><br><span class="hljs-comment">#oracle_home=/usr/share/oracle/instantclient</span><br><br><span class="hljs-comment">## Location of Cloudera Management Services files.</span><br>[Cloudera]<br><span class="hljs-comment">#mgmt_home=/usr/share/cmf</span><br><br><span class="hljs-comment">## Location of JDBC Drivers.</span><br>[JDBC]<br><span class="hljs-comment">#cloudera_mysql_connector_jar=/usr/share/java/mysql-connector-java.jar</span><br><span class="hljs-comment">#cloudera_oracle_connector_jar=/usr/share/java/oracle-connector-java.jar</span><br><span class="hljs-comment">#By default, postgres jar is found dynamically in $MGMT_HOME/lib</span><br><span class="hljs-comment">#cloudera_postgresql_jdbc_jar=</span><br><br>[Cgroup_Paths]<br><span class="hljs-comment"># This section lists paths that agent will use to figure out resource allocation</span><br><span class="hljs-comment"># If not specified then agent will use the cgroup that agent process is part of</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Note: do not add /sys/fs/cgroup in the path. cgroups mounted inside container will</span><br><span class="hljs-comment"># be used to figure out the subsystems.</span><br><span class="hljs-comment">#cpu_cgroup_path=/</span><br><span class="hljs-comment">#cpuacct_cgroup_path=/</span><br><span class="hljs-comment">#blkio_cgroup_path=/</span><br><span class="hljs-comment"><code class="language-hljs bash"><span class="hljs-comment"># Configuration file for cloudera-scm-agent.</span><br><span class="hljs-comment"># Please note that this file supports multi-line values.  Multi-line</span><br><span class="hljs-comment"># values are indicated by indenting following lines with a space.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># If you have whitespace in front of a parameter name, it will be</span><br><span class="hljs-comment"># read as a continuation of the previous parameter value.  Please</span><br><span class="hljs-comment"># be careful not to leave spaces in front of parameter names.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># To check if this file has spaces in front of parameters names</span><br><span class="hljs-comment"># you can do a grep like this:</span><br><span class="hljs-comment">#  grep '^[[:blank:]]' /etc/cloudera-scm-agent/config.ini</span><br><br>[General]<br><span class="hljs-comment"># Hostname of the CM server.</span><br>server_host={{ groups[<span class="hljs-string">'CDM'</span>][0] }}<br><br><span class="hljs-comment"># Port that the CM server is listening on.</span><br>server_port=7182<br><br><span class="hljs-comment">## It should not normally be necessary to modify these.</span><br><span class="hljs-comment"># Port that the CM agent should listen on.</span><br><span class="hljs-comment"># listening_port=9000</span><br><br><span class="hljs-comment"># IP Address that the CM agent should listen on.</span><br><span class="hljs-comment"># listening_ip=</span><br><br><span class="hljs-comment"># Hostname that the CM agent reports as its hostname. If unset, will be</span><br><span class="hljs-comment"># obtained in code through something like this:</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#   python -c 'import socket; \</span><br><span class="hljs-comment">#              print socket.getfqdn(), \</span><br><span class="hljs-comment">#                    socket.gethostbyname(socket.getfqdn())'</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># listening_hostname=</span><br><br><span class="hljs-comment"># An alternate hostname to report as the hostname for this host in CM.</span><br><span class="hljs-comment"># Useful when this agent is behind a load balancer or proxy and all</span><br><span class="hljs-comment"># inbound communication must connect through that proxy.</span><br><span class="hljs-comment"># reported_hostname=</span><br><br><span class="hljs-comment"># Port that supervisord should listen on.</span><br><span class="hljs-comment"># NB: This only takes effect if supervisord is restarted.</span><br><span class="hljs-comment"># supervisord_port=19001</span><br><br><span class="hljs-comment"># Log file.  The supervisord log file will be placed into</span><br><span class="hljs-comment"># the same directory.  Note that if the agent is being started via the</span><br><span class="hljs-comment"># init.d script, /var/log/cloudera-scm-agent/cloudera-scm-agent.out will</span><br><span class="hljs-comment"># also have a small amount of output (from before logging is initialized).</span><br><span class="hljs-comment"># log_file=/var/log/cloudera-scm-agent/cloudera-scm-agent.log</span><br><br><span class="hljs-comment"># Persistent state directory.  Directory to store CM agent state that</span><br><span class="hljs-comment"># persists across instances of the agent process and system reboots.</span><br><span class="hljs-comment"># Particularly, the agent's UUID is stored here.</span><br><span class="hljs-comment"># lib_dir=/var/lib/cloudera-scm-agent</span><br><br><span class="hljs-comment"># Parcel directory.  Unpacked parcels will be stored in this directory.</span><br><span class="hljs-comment"># Downloaded parcels will be stored in &lt;parcel_dir&gt;/../parcel-cache</span><br><span class="hljs-comment"># parcel_dir=/opt/cloudera/parcels</span><br><br><span class="hljs-comment"># Enable supervisord event monitoring.  Used in eager heartbeating, amongst</span><br><span class="hljs-comment"># other things.</span><br><span class="hljs-comment"># enable_supervisord_events=true</span><br><br><span class="hljs-comment"># Maximum time to wait (in seconds) for all metric collectors to finish</span><br><span class="hljs-comment"># collecting data.</span><br>max_collection_wait_seconds=10.0<br><br><span class="hljs-comment"># Maximum time to wait (in seconds) when connecting to a local role's</span><br><span class="hljs-comment"># webserver to fetch metrics.</span><br>metrics_url_timeout_seconds=30.0<br><br><span class="hljs-comment"># Maximum time to wait (in seconds) when connecting to a local TaskTracker</span><br><span class="hljs-comment"># to fetch task attempt data.</span><br>task_metrics_timeout_seconds=5.0<br><br><span class="hljs-comment"># The list of non-device (nodev) filesystem types which will be monitored.</span><br>monitored_nodev_filesystem_types=nfs,nfs4,tmpfs<br><br><span class="hljs-comment"># The list of filesystem types which are considered local for monitoring purposes.</span><br><span class="hljs-comment"># These filesystems are combined with the other local filesystem types found in</span><br><span class="hljs-comment"># /proc/filesystems</span><br>local_filesystem_whitelist=ext2,ext3,ext4,xfs<br><br><span class="hljs-comment"># The largest size impala profile log bundle that this agent will serve to the</span><br><span class="hljs-comment"># CM server. If the CM server requests more than this amount, the bundle will</span><br><span class="hljs-comment"># be limited to this size. All instances of this limit being hit are logged to</span><br><span class="hljs-comment"># the agent log.</span><br>impala_profile_bundle_max_bytes=1073741824<br><br><span class="hljs-comment"># The largest size stacks log bundle that this agent will serve to the CM</span><br><span class="hljs-comment"># server. If the CM server requests more than this amount, the bundle will be</span><br><span class="hljs-comment"># limited to this size. All instances of this limit being hit are logged to the</span><br><span class="hljs-comment"># agent log.</span><br>stacks_log_bundle_max_bytes=1073741824<br><br><span class="hljs-comment"># The size to which the uncompressed portion of a stacks log can grow before it</span><br><span class="hljs-comment"># is rotated. The log will then be compressed during rotation.</span><br>stacks_log_max_uncompressed_file_size_bytes=5242880<br><br><span class="hljs-comment"># The orphan process directory staleness threshold. If a diretory is more stale</span><br><span class="hljs-comment"># than this amount of seconds, CM agent will remove it.</span><br>orphan_process_dir_staleness_threshold=5184000<br><br><span class="hljs-comment"># The orphan process directory refresh interval. The CM agent will check the</span><br><span class="hljs-comment"># staleness of the orphan processes config directory every this amount of</span><br><span class="hljs-comment"># seconds.</span><br>orphan_process_dir_refresh_interval=3600<br><br><span class="hljs-comment"># A knob to control the agent logging level. The options are listed as follows:</span><br><span class="hljs-comment"># 1) DEBUG (set the agent logging level to 'logging.DEBUG')</span><br><span class="hljs-comment"># 2) INFO (set the agent logging level to 'logging.INFO')</span><br>scm_debug=INFO<br><br><span class="hljs-comment"># The DNS resolution collecion interval in seconds. A java base test program</span><br><span class="hljs-comment"># will be executed with at most this frequency to collect java DNS resolution</span><br><span class="hljs-comment"># metrics. The test program is only executed if the associated health test,</span><br><span class="hljs-comment"># Host DNS Resolution, is enabled.</span><br>dns_resolution_collection_interval_seconds=60<br><br><span class="hljs-comment"># The maximum time to wait (in seconds) for the java test program to collect</span><br><span class="hljs-comment"># java DNS resolution metrics.</span><br>dns_resolution_collection_timeout_seconds=30<br><br><span class="hljs-comment"># The directory location in which the agent-wide kerberos credential cache</span><br><span class="hljs-comment"># will be created.</span><br><span class="hljs-comment"># agent_wide_credential_cache_location=/var/run/cloudera-scm-agent</span><br><br>[Security]<br><span class="hljs-comment"># Use TLS and certificate validation when connecting to the CM server.</span><br>use_tls=0<br><br><span class="hljs-comment"># The maximum allowed depth of the certificate chain returned by the peer.</span><br><span class="hljs-comment"># The default value of 9 matches the default specified in openssl's</span><br><span class="hljs-comment"># SSL_CTX_set_verify.</span><br>max_cert_depth=9<br><br><span class="hljs-comment"># A file of CA certificates in PEM format. The file can contain several CA</span><br><span class="hljs-comment"># certificates identified by</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># -----BEGIN CERTIFICATE-----</span><br><span class="hljs-comment"># ... (CA certificate in base64 encoding) ...</span><br><span class="hljs-comment"># -----END CERTIFICATE-----</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># sequences. Before, between, and after the certificates text is allowed which</span><br><span class="hljs-comment"># can be used e.g. for descriptions of the certificates.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># The file is loaded once, the first time an HTTPS connection is attempted. A</span><br><span class="hljs-comment"># restart of the agent is required to pick up changes to the file.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Note that if neither verify_cert_file or verify_cert_dir is set, certificate</span><br><span class="hljs-comment"># verification will not be performed.</span><br><span class="hljs-comment"># verify_cert_file=</span><br><br><span class="hljs-comment"># Directory containing CA certificates in PEM format. The files each contain one</span><br><span class="hljs-comment"># CA certificate. The files are looked up by the CA subject name hash value,</span><br><span class="hljs-comment"># which must hence be available. If more than one CA certificate with the same</span><br><span class="hljs-comment"># name hash value exist, the extension must be different (e.g. 9d66eef0.0,</span><br><span class="hljs-comment"># 9d66eef0.1 etc). The search is performed in the ordering of the extension</span><br><span class="hljs-comment"># number, regardless of other properties of the certificates. Use the c_rehash</span><br><span class="hljs-comment"># utility to create the necessary links.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># The certificates in the directory are only looked up when required, e.g. when</span><br><span class="hljs-comment"># building the certificate chain or when actually performing the verification</span><br><span class="hljs-comment"># of a peer certificate. The contents of the directory can thus be changed</span><br><span class="hljs-comment"># without an agent restart.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># When looking up CA certificates, the verify_cert_file is first searched, then</span><br><span class="hljs-comment"># those in the directory. Certificate matching is done based on the subject name,</span><br><span class="hljs-comment"># the key identifier (if present), and the serial number as taken from the</span><br><span class="hljs-comment"># certificate to be verified. If these data do not match, the next certificate</span><br><span class="hljs-comment"># will be tried. If a first certificate matching the parameters is found, the</span><br><span class="hljs-comment"># verification process will be performed; no other certificates for the same</span><br><span class="hljs-comment"># parameters will be searched in case of failure.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Note that if neither verify_cert_file or verify_cert_dir is set, certificate</span><br><span class="hljs-comment"># verification will not be performed.</span><br><span class="hljs-comment"># verify_cert_dir=</span><br><br><span class="hljs-comment"># PEM file containing client private key.</span><br><span class="hljs-comment"># client_key_file=</span><br><br><span class="hljs-comment"># A command to run which returns the client private key password on stdout</span><br><span class="hljs-comment"># client_keypw_cmd=</span><br><br><span class="hljs-comment"># If client_keypw_cmd isn't specified, instead a text file containing</span><br><span class="hljs-comment"># the client private key password can be used.</span><br><span class="hljs-comment"># client_keypw_file=</span><br><br><span class="hljs-comment"># PEM file containing client certificate.</span><br><span class="hljs-comment"># client_cert_file=</span><br><br><span class="hljs-comment">## Location of Hadoop files.  These are the CDH locations when installed by</span><br><span class="hljs-comment">## packages.  Unused when CDH is installed by parcels.</span><br>[Hadoop]<br><span class="hljs-comment">#cdh_crunch_home=/usr/lib/crunch</span><br><span class="hljs-comment">#cdh_flume_home=/usr/lib/flume-ng</span><br><span class="hljs-comment">#cdh_hadoop_bin=/usr/bin/hadoop</span><br><span class="hljs-comment">#cdh_hadoop_home=/usr/lib/hadoop</span><br><span class="hljs-comment">#cdh_hbase_home=/usr/lib/hbase</span><br><span class="hljs-comment">#cdh_hbase_indexer_home=/usr/lib/hbase-solr</span><br><span class="hljs-comment">#cdh_hcat_home=/usr/lib/hive-hcatalog</span><br><span class="hljs-comment">#cdh_hdfs_home=/usr/lib/hadoop-hdfs</span><br><span class="hljs-comment">#cdh_hive_home=/usr/lib/hive</span><br><span class="hljs-comment">#cdh_httpfs_home=/usr/lib/hadoop-httpfs</span><br><span class="hljs-comment">#cdh_hue_home=/usr/share/hue</span><br><span class="hljs-comment">#cdh_hue_plugins_home=/usr/lib/hadoop</span><br><span class="hljs-comment">#cdh_impala_home=/usr/lib/impala</span><br><span class="hljs-comment">#cdh_kudu_home=/usr/lib/kudu</span><br><span class="hljs-comment">#cdh_llama_home=/usr/lib/llama</span><br><span class="hljs-comment">#cdh_mr1_home=/usr/lib/hadoop-0.20-mapreduce</span><br><span class="hljs-comment">#cdh_mr2_home=/usr/lib/hadoop-mapreduce</span><br><span class="hljs-comment">#cdh_oozie_home=/usr/lib/oozie</span><br><span class="hljs-comment">#cdh_parquet_home=/usr/lib/parquet</span><br><span class="hljs-comment">#cdh_pig_home=/usr/lib/pig</span><br><span class="hljs-comment">#cdh_solr_home=/usr/lib/solr</span><br><span class="hljs-comment">#cdh_spark_home=/usr/lib/spark</span><br><span class="hljs-comment">#cdh_sqoop_home=/usr/lib/sqoop</span><br><span class="hljs-comment">#cdh_sqoop2_home=/usr/lib/sqoop2</span><br><span class="hljs-comment">#cdh_yarn_home=/usr/lib/hadoop-yarn</span><br><span class="hljs-comment">#cdh_zookeeper_home=/usr/lib/zookeeper</span><br><span class="hljs-comment">#hive_default_xml=/etc/hive/conf.dist/hive-default.xml</span><br><span class="hljs-comment">#webhcat_default_xml=/etc/hive-webhcat/conf.dist/webhcat-default.xml</span><br><span class="hljs-comment">#jsvc_home=/usr/libexec/bigtop-utils</span><br><span class="hljs-comment">#tomcat_home=/usr/lib/bigtop-tomcat</span><br><span class="hljs-comment">#oracle_home=/usr/share/oracle/instantclient</span><br><br><span class="hljs-comment">## Location of Cloudera Management Services files.</span><br>[Cloudera]<br><span class="hljs-comment">#mgmt_home=/usr/share/cmf</span><br><br><span class="hljs-comment">## Location of JDBC Drivers.</span><br>[JDBC]<br><span class="hljs-comment">#cloudera_mysql_connector_jar=/usr/share/java/mysql-connector-java.jar</span><br><span class="hljs-comment">#cloudera_oracle_connector_jar=/usr/share/java/oracle-connector-java.jar</span><br><span class="hljs-comment">#By default, postgres jar is found dynamically in $MGMT_HOME/lib</span><br><span class="hljs-comment">#cloudera_postgresql_jdbc_jar=</span><br><br>[Cgroup_Paths]<br><span class="hljs-comment"># This section lists paths that agent will use to figure out resource allocation</span><br><span class="hljs-comment"># If not specified then agent will use the cgroup that agent process is part of</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Note: do not add /sys/fs/cgroup in the path. cgroups mounted inside container will</span><br><span class="hljs-comment"># be used to figure out the subsystems.</span><br><span class="hljs-comment">#cpu_cgroup_path=/</span><br><span class="hljs-comment">#cpuacct_cgroup_path=/</span><br><span class="hljs-comment">#blkio_cgroup_path=/</span><br><span class="hljs-comment">#memory_cgroup_path=/</span><br></code></span></pre></div></td></tr></tbody></table></figure>

<h3 id="2-2-db-properties-cloudera-scm-server-需要"><a href="#2-2-db-properties-cloudera-scm-server-需要" class="headerlink" title=".2.2. db.properties : cloudera-scm-server 需要"></a>.2.2. db.properties : cloudera-scm-server 需要</h3><figure class="highlight markdown"><table><tbody><tr><td class="gutter"><div class="hljs"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs"><pre class=" language-hljs markdown"><span class="hljs-section"># Copyright (c) 2012 Cloudera, Inc. All rights reserved.</span><br><span class="hljs-section">#</span><br><span class="hljs-section"># This file describes the database connection.</span><br><span class="hljs-section">#</span><br><br><span class="hljs-section"># The database type</span><br><span class="hljs-section"># Currently 'mysql', 'postgresql' and 'oracle' are valid databases.</span><br>com.cloudera.cmf.db.type=mysql<br><br><span class="hljs-section"># The database host</span><br><span class="hljs-section"># If a non standard port is needed, use 'hostname:port'</span><br>com.cloudera.cmf.db.host={{ groups[<span class="hljs-string">'MySQL'</span>][<span class="hljs-symbol">0</span>] }}<br><br><span class="hljs-section"># The database name</span><br>com.cloudera.cmf.db.name={{ cmd<span class="hljs-emphasis">_db_</span>name }}<br><br><span class="hljs-section"># The database user</span><br>com.cloudera.cmf.db.user={{ root_user }}<br><br><span class="hljs-section"># The database user's password</span><br>com.cloudera.cmf.db.password={{ root_password }}<br><br><span class="hljs-section"># The db setup type</span><br><span class="hljs-section"># After fresh install it is set to INIT</span><br><span class="hljs-section"># and will be changed post config.</span><br><span class="hljs-section"># If scm-server uses Embedded DB then it is set to EMBEDDED</span><br><span class="hljs-section"><code class="language-hljs markdown"><span class="hljs-section"># Copyright (c) 2012 Cloudera, Inc. All rights reserved.</span><br><span class="hljs-section">#</span><br><span class="hljs-section"># This file describes the database connection.</span><br><span class="hljs-section">#</span><br><br><span class="hljs-section"># The database type</span><br><span class="hljs-section"># Currently 'mysql', 'postgresql' and 'oracle' are valid databases.</span><br>com.cloudera.cmf.db.type=mysql<br><br><span class="hljs-section"># The database host</span><br><span class="hljs-section"># If a non standard port is needed, use 'hostname:port'</span><br>com.cloudera.cmf.db.host={{ groups[<span class="hljs-string">'MySQL'</span>][<span class="hljs-symbol">0</span>] }}<br><br><span class="hljs-section"># The database name</span><br>com.cloudera.cmf.db.name={{ cmd<span class="hljs-emphasis">_db_</span>name }}<br><br><span class="hljs-section"># The database user</span><br>com.cloudera.cmf.db.user={{ root_user }}<br><br><span class="hljs-section"># The database user's password</span><br>com.cloudera.cmf.db.password={{ root_password }}<br><br><span class="hljs-section"># The db setup type</span><br><span class="hljs-section"># After fresh install it is set to INIT</span><br><span class="hljs-section"># and will be changed post config.</span><br><span class="hljs-section"># If scm-server uses Embedded DB then it is set to EMBEDDED</span><br><span class="hljs-section"># If scm-server uses External DB then it is set to EXTERNAL</span><br>com.cloudera.cmf.db.setupType=EXTERNAL ## external with mysql<br></code></span></pre></div></td></tr></tbody></table></figure>

<h2 id="3-部署编排"><a href="#3-部署编排" class="headerlink" title=".3. 部署编排"></a>.3. 部署编排</h2><figure class="highlight"><table><tbody><tr><td class="gutter"><div class="hljs"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></div></td><td class="code"><div class="hljs"><pre class=" language-hljs json"><code class="language-hljs json">---<br><br>- hosts: CDM:Common<br>  tasks:<br>  - name: copy hosts<br>    copy:<br>        src: confs/hosts<br>        dest: /etc/hosts<br><br>  - name: set hostname<br>    hostname: name={{ inventory_hostname }}<br><br>  - name: copy oracle-jdk1.8<br>    copy:<br>        src: confs/oracle-j2sdk1.8-1.8.0+update181-1.x86_64.rpm <br>        dest: /tmp/oracle-j2sdk1.8-1.8.0+update181-1.x86_64.rpm <br><br>  - name: install oracle-jdk1.8<br>    shell: rpm -Uvh --replacepkgs  /tmp/oracle-j2sdk1.8-1.8.0+update181-1.x86_64.rpm <br><br>  - name: install rpcbind<br>    shell: yum install -y rpcbind<br>    ignore_errors: true<br><br>  - name: set java_home<br>    lineinfile:<br>        path: /etc/profile<br>        line: export JAVA_HOME=/usr/lib/jvm/java<br>        state: absent<br> <br>  - name: install needed packages<br>    shell: yum install cyrus-sasl-gssapi fuse fuse-libs httpd mod_ssl openssl-devel python-psycopg2 MySQL-python -y<br><br>  - name: configure each-cred<br>    shell: echo -e "y\ny\n" | ssh-keygen -q -t rsa -f /root/.ssh/id_rsa -C "" -N ""<br><br>  - name: cat ssh-key auths<br>    shell: cat /root/.ssh/id_rsa.pub<br>    register: id_rsa<br><br>  - name: touch authorized_keys<br>    shell: |<br>        echo "ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEArk0cjBbDgdke86pN9962BjcsyxUNhvtW8rkzmykqCPu2QlQxwCg5OikQxmcJUakCkkGhww88U9gx+gPgoJZ9UtClRqHbJKbyqu5XXYFfxjjjRa4N60d5wXXgga2UB6RVIgA+snPxBKi6oFlvH5jV7h3lHxRo3JRQt51/NmcbkyZyUIF7bOJztB9C85jw7dk4dXG52M9bN+FtVlGiVCVKZRWHHoEUVt7y1ZUaao5Ceqw0nAL9JZfQK1zQhrq7YI8pN3ssI35ZKL7EkVKy+qs9GplJFfTBvXO5Q0btFMtM6cY1fMEv9PIt3n0uZF1kGjAHyrAPYnQPcb3H6sDCLQJQ+Q== tp_cloud_hadoop@qiyi.com" &gt; /root/.ssh/authorized_keys<br>        chmod 600 /root/.ssh/authorized_keys<br><br>  - name: set public-keys to each nodes<br>    lineinfile:<br>        path: /root/.ssh/authorized_keys<br>        line: "{{ hostvars[item].id_rsa.stdout }}"<br>        state: present<br>    with_items:<br>        - "{{ groups['Common'] | union(groups['CDM']) | unique }}"<br><br>- hosts: CDM<br>  tasks:<br>  - name: make sure mysql-connector exists<br>    shell: mkdir -p /usr/share/java<br><br>  - name: copy mysql-connector<br>    copy:<br>        src: confs/mysql-connector-java.jar<br>        dest: /usr/share/java/mysql-connector-java.jar<br><br>  - name: copy files<br>    copy: <br>        src: "confs/{{ item }}"<br>        dest: "/tmp/{{ item }}"<br>    with_items:<br>        - cloudera-manager-daemons-6.2.0-968826.el7.x86_64.rpm<br>        - cloudera-manager-server-6.2.0-968826.el7.x86_64.rpm<br>        - cloudera-manager-server-db-2-6.2.0-968826.el7.x86_64.rpm<br>        - cloudera-manager-agent-6.2.0-968826.el7.x86_64.rpm<br><br>  - name: install rpm<br>    shell: rpm -Uvh --replacepkgs /tmp/{{ item }}<br>    with_items:<br>        - cloudera-manager-daemons-6.2.0-968826.el7.x86_64.rpm<br>        - cloudera-manager-server-6.2.0-968826.el7.x86_64.rpm<br>        - cloudera-manager-server-db-2-6.2.0-968826.el7.x86_64.rpm<br>        - cloudera-manager-agent-6.2.0-968826.el7.x86_64.rpm<br><br>  - name: create target directory<br>    file:<br>        path: /opt/cloudera/parcels<br>        state: directory<br>        owner: cloudera-scm<br><br>  - name: copy parcells file<br>    copy:<br>        src: "confs/cdh/{{ item }}"<br>        dest: "/opt/cloudera/parcels/{{ item }}"<br>    with_items:<br>        - CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel.sha<br>        - CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel.sha256<br>        - manifest.json<br>        - CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel<br><br>  - name: copy template files<br>    template:<br>        src: confs/db.properties<br>        dest: /etc/cloudera-scm-server/db.properties<br><br>- hosts: Common<br>  tasks:<br>  - name: copy files<br>    copy: <br>        src: "confs/{{ item }}"<br>        dest: "/tmp/{{ item }}"<br>    with_items:<br>        - cloudera-manager-daemons-6.2.0-968826.el7.x86_64.rpm<br>        - cloudera-manager-agent-6.2.0-968826.el7.x86_64.rpm<br><br>  - name: install rpm<br>    shell: rpm -Uvh --replacepkgs /tmp/{{ item }}<br>    with_items:<br>        - cloudera-manager-daemons-6.2.0-968826.el7.x86_64.rpm<br>        - cloudera-manager-agent-6.2.0-968826.el7.x86_64.rpm<br><br>- hosts: CDM:Common<br>  tasks:<br>  - name: configure client conf<br>    template:<br>        src: confs/config.ini<br>        dest: /etc/cloudera-scm-agent/config.ini<br><br>  - name: configure ntpd service<br>    include: ntpd.yml ## 公网或公司服务<br></code></pre></div></td></tr></tbody></table></figure>

<h2 id="4-其他补充"><a href="#4-其他补充" class="headerlink" title=".4. 其他补充"></a>.4. 其他补充</h2><h3 id="4-1-创建MySQL数据库"><a href="#4-1-创建MySQL数据库" class="headerlink" title=".4.1. 创建MySQL数据库"></a>.4.1. 创建MySQL数据库</h3><figure class="highlight"><table><tbody><tr><td class="gutter"><div class="hljs"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs"><pre class=" language-hljs json"><code class="language-hljs json">CREATE DATABASE mydatabase CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci;<br></code></pre></div></td></tr></tbody></table></figure>

<h3 id="4-2-初始化SCM数据库"><a href="#4-2-初始化SCM数据库" class="headerlink" title=".4.2. 初始化SCM数据库"></a>.4.2. 初始化SCM数据库</h3><figure class="highlight"><table><tbody><tr><td class="gutter"><div class="hljs"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs"><pre class=" language-hljs json"><code class="language-hljs json">/opt/cloudera/cm/schema/scm_prepare_database.sh -h[MySQL Host/IP ] -P 3306 -u [Admin User Name] -p[Admin User Password]  mysql scm scm "Scm@123456"  -f<br></code></pre></div></td></tr></tbody></table></figure>
            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/CDH/">CDH</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2020/06/13/Hadoop%E5%B7%A5%E5%85%B7%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/">
                        <span class="hidden-mobile">工具知识总结</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">×</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script>



<!-- Plugins -->


  
    
  



  <script defer="" src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script>
  







  <script src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js"></script>
  



  <script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script>
  



  <script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script>
  



  
  



  <script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  

  






















<script src="/bundle.js"></script><script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  ;

    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "部署CDH6.2组件&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  ;

    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  ;

    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  ;

    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script></body></html>